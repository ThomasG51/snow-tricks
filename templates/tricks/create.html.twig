{% extends 'base.html.twig' %}

{% block body %}
    <div class="bg-gray-100 pt-32 pb-14">
    <!-- TODO responsive -->
        <main class="w-3/5 py-12 mx-auto bg-white shadow">
            <h1 class="text-3xl text-blue-400 w-1/2 mx-auto text-center mb-10"><i class="fas fa-plus mr-1"></i> Ajouter un nouveau trick</h1>

            {{ form_start(formTricks) }}
                <div class="w-10/12 mx-auto mb-8">
                    {{ form_label(formTricks.name, null, {
                        'label': 'Titre',
                        'label_attr': {'class': 'font-semibold text-blue-400'}
                    }) }}
                    {{ form_errors(formTricks.name) }}
                    {{ form_widget(formTricks.name) }}
                </div>
                <div class="w-10/12 mx-auto mb-8">
                    {{ form_label(formTricks.content, null, {
                        'label': 'Difficulté',
                        'label_attr': {'class': 'font-semibold text-blue-400'}
                    }) }}
                    {{ form_errors(formTricks.content) }}

                    <input type="text" id="rangeValue" class="font-semibold text-blue-400" value=" : Intermédiaire">
                    {{ form_widget(formTricks.difficulty) }}
                </div>
                <div class="w-10/12 mx-auto mb-8 videos">
                    {{ form_label(formTricks.videos, null, {
                        'label': 'Vidéos (url)',
                        'label_attr': {'class': 'font-semibold text-blue-400'}
                    }) }}
                    <ul id="videos"
                        data-prototype="{{ form_widget(formTricks.videos.vars.prototype)|e('html_attr') }}"
                        data-widget-tags="{{ '<li></li>'|e }}"
                        data-widget-counter="{{ formTricks.videos|length }}">
                            {{ form_errors(formTricks.videos) }}
                            {{ form_widget(formTricks.videos) }}
                    </ul>
                    <button type="button" class="add-another-collection-widget bg-blue-400 text-white px-2 py-1 mt-3" data-list-selector="#videos"><i class="fas fa-plus"></i></button>
                </div>
                <div class="w-10/12 mx-auto mb-8">
                    {{ form_label(formTricks.category, null, {
                        'label': 'Category du tricks',
                        'label_attr': {'class': 'font-semibold text-blue-400'}
                    }) }}
                    {{ form_errors(formTricks.category) }}
                    {{ form_widget(formTricks.category) }}
                </div>
                <div class="w-10/12 mx-auto mb-8">
                    {{ form_label(formTricks.content, null, {
                        'label': 'Description',
                        'label_attr': {'class': 'font-semibold text-blue-400'}
                    }) }}
                    {{ form_errors(formTricks.content) }}
                    {{ form_widget(formTricks.content) }}
                </div>
                <div class="w-10/12 mx-auto">
                    <button type="submit" class="bg-blue-400 text-white rounded w-full px-2 py-2">Enregistrer</button>
                </div>
            {{ form_end(formTricks) }}
        </main>
    </div>
{% endblock %}

{% block javascripts %}
<script src="https://code.jquery.com/jquery-3.5.1.slim.js" integrity="sha256-DrT5NfxfbHvMHux31Lkhxg42LY6of8TaYyK50jnxRnM=" crossOrigin="anonymous"></script>

<script type="text/javascript">
    document.getElementById('topbar').classList.add('bg-gray-800');

    /*
     * Create Tricks Page : Show Range Value
     */

    function showRangeValue(value) {
        switch(value)
        {
            case '1':
                document.getElementById('rangeValue').value= ' : Débutant';
                document.getElementById('rangeValue').classList.value = '';
                document.getElementById('rangeValue').classList.add('font-semibold','text-green-400');
                break;
            case '2':
                document.getElementById('rangeValue').value= ' : Intermédiaire';
                document.getElementById('rangeValue').classList.value = '';
                document.getElementById('rangeValue').classList.add('font-semibold','text-blue-400');
                break;
            case '3':
                document.getElementById('rangeValue').value= ' : Expert';
                document.getElementById('rangeValue').classList.value = '';
                document.getElementById('rangeValue').classList.add('font-semibold','text-red-400');
                break;
        }
    }


    /*
     * Create Tricks Page : Add videos row
     */

    jQuery(document).ready(function () {
        jQuery('.add-another-collection-widget').click(function (e) {
            var list = jQuery(jQuery(this).attr('data-list-selector'));
            // Try to find the counter of the list or use the length of the list
            var counter = list.data('widget-counter') || list.children().length;

            // grab the prototype template
            var newWidget = list.attr('data-prototype');
            // replace the "__name__" used in the id and name of the prototype
            // with a number that's unique to your emails
            // end name attribute looks like name="contact[emails][2]"
            newWidget = newWidget.replace(/__name__/g, counter);
            // Increase the counter
            counter++;
            // And store it, the length cannot be used if deleting widgets is allowed
            list.data('widget-counter', counter);

            // create a new list element and add it to the list
            var newElem = jQuery(list.attr('data-widget-tags')).html(newWidget);
            newElem.appendTo(list);
        });
    });
</script>
{% endblock %}